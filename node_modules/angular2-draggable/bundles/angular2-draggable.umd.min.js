!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("angular2-draggable",["exports","@angular/core"],t):t(e["angular2-draggable"]={},e.ng.core)}(this,function(e,n){"use strict";var i=function(){function i(e,t){this.x=e,this.y=t}return i.fromEvent=function(e){return e instanceof MouseEvent?new i(e.clientX,e.clientY):new i(e.changedTouches[0].clientX,e.changedTouches[0].clientY)},i.isIPosition=function(e){return!!e&&"x"in e&&"y"in e},i.getCurrent=function(e){var t=new i(0,0);if(window){var n=window.getComputedStyle(e);return n&&(t.x=parseInt(n.getPropertyValue("left"),10),t.y=parseInt(n.getPropertyValue("top"),10)),t}return console.error("Not Supported!"),null},i.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},i.prototype.subtract=function(e){return this.x-=e.x,this.y-=e.y,this},i.prototype.reset=function(){return this.x=0,this.y=0,this},i.prototype.set=function(e){return this.x=e.x,this.y=e.y,this},i}(),t=function(){function e(e,t){this.el=e,this.renderer=t,this.allowDrag=!0,this.moving=!1,this.orignal=null,this.oldTrans=new i(0,0),this.tempTrans=new i(0,0),this.oldZIndex="",this.oldPosition="",this._zIndex="",this.needTransform=!1,this.started=new n.EventEmitter,this.stopped=new n.EventEmitter,this.edge=new n.EventEmitter,this.outOfBounds={top:!1,right:!1,bottom:!1,left:!1},this.gridSize=1,this.inBounds=!1,this.trackPosition=!0,this.scale=1,this.preventDefaultEvent=!1,this.position={x:0,y:0},this.movingOffset=new n.EventEmitter,this.endOffset=new n.EventEmitter}return Object.defineProperty(e.prototype,"zIndex",{set:function(e){this.renderer.setStyle(this.el.nativeElement,"z-index",e),this._zIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ngDraggable",{set:function(e){if(e!==undefined&&null!==e&&""!==e){this.allowDrag=!!e;var t=this.handle?this.handle:this.el.nativeElement;this.allowDrag?this.renderer.addClass(t,"ng-draggable"):this.renderer.removeClass(t,"ng-draggable")}},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){if(this.allowDrag){var e=this.handle?this.handle:this.el.nativeElement;this.renderer.addClass(e,"ng-draggable")}this.resetPosition()},e.prototype.ngOnChanges=function(e){if(e.position&&!e.position.isFirstChange()){var t=e.position.currentValue;this.moving?this.needTransform=!0:(i.isIPosition(t)?this.oldTrans.set(t):this.oldTrans.reset(),this.transform())}},e.prototype.resetPosition=function(){i.isIPosition(this.position)?this.oldTrans.set(this.position):this.oldTrans.reset(),this.tempTrans.reset(),this.transform()},e.prototype.moveTo=function(e){this.orignal&&(e.subtract(this.orignal),this.tempTrans.set(e),this.transform(),this.bounds&&this.edge.emit(this.boundsCheck()),this.movingOffset.emit({x:this.tempTrans.x+this.oldTrans.x,y:this.tempTrans.y+this.oldTrans.y}))},e.prototype.transform=function(){var e=this.tempTrans.x+this.oldTrans.x,t=this.tempTrans.y+this.oldTrans.y;1<this.gridSize&&(e=Math.round(e/this.gridSize)*this.gridSize,t=Math.round(t/this.gridSize)*this.gridSize);var n="translate("+e+"px, "+t+"px)";1!==this.scale&&(n+=" scale("+this.scale+")"),this.renderer.setStyle(this.el.nativeElement,"transform",n),this.renderer.setStyle(this.el.nativeElement,"-webkit-transform",n),this.renderer.setStyle(this.el.nativeElement,"-ms-transform",n),this.renderer.setStyle(this.el.nativeElement,"-moz-transform",n),this.renderer.setStyle(this.el.nativeElement,"-o-transform",n)},e.prototype.pickUp=function(){this.oldZIndex=this.el.nativeElement.style.zIndex?this.el.nativeElement.style.zIndex:"",window&&(this.oldZIndex=window.getComputedStyle(this.el.nativeElement,null).getPropertyValue("z-index")),this.zIndexMoving&&this.renderer.setStyle(this.el.nativeElement,"z-index",this.zIndexMoving),this.moving||(this.started.emit(this.el.nativeElement),this.moving=!0)},e.prototype.boundsCheck=function(){if(this.bounds){var e=this.bounds.getBoundingClientRect(),t=this.el.nativeElement.getBoundingClientRect(),n={top:!!this.outOfBounds.top||e.top<t.top,right:!!this.outOfBounds.right||e.right>t.right,bottom:!!this.outOfBounds.bottom||e.bottom>t.bottom,left:!!this.outOfBounds.left||e.left<t.left};return this.inBounds&&(n.top||(this.tempTrans.y-=t.top-e.top),n.bottom||(this.tempTrans.y-=t.bottom-e.bottom),n.right||(this.tempTrans.x-=t.right-e.right),n.left||(this.tempTrans.x-=t.left-e.left),this.transform()),n}},e.prototype.putBack=function(){this._zIndex?this.renderer.setStyle(this.el.nativeElement,"z-index",this._zIndex):this.zIndexMoving&&(this.oldZIndex?this.renderer.setStyle(this.el.nativeElement,"z-index",this.oldZIndex):this.el.nativeElement.style.removeProperty("z-index")),this.moving&&(this.stopped.emit(this.el.nativeElement),this.needTransform&&(i.isIPosition(this.position)?this.oldTrans.set(this.position):this.oldTrans.reset(),this.transform(),this.needTransform=!1),this.bounds&&this.edge.emit(this.boundsCheck()),this.moving=!1,this.endOffset.emit({x:this.tempTrans.x+this.oldTrans.x,y:this.tempTrans.y+this.oldTrans.y}),this.trackPosition&&this.oldTrans.add(this.tempTrans),this.tempTrans.reset(),this.trackPosition||this.transform())},e.prototype.checkHandleTarget=function(e,t){if("BUTTON"===t.tagName)return!1;if(t===e)return!0;for(var n in t.children)if(t.children.hasOwnProperty(n)&&this.checkHandleTarget(e,t.children[n]))return!0;return!1},e.prototype.onMouseDown=function(e){if(!(e instanceof MouseEvent&&2===e.button)){var t=e.target||e.srcElement;(this.handle===undefined||this.checkHandleTarget(t,this.handle))&&(this.preventDefaultEvent&&(e.stopPropagation(),e.preventDefault()),this.orignal=i.fromEvent(e),this.pickUp())}},e.prototype.onMouseLeave=function(){this.putBack()},e.prototype.onMouseMove=function(e){this.moving&&this.allowDrag&&(this.preventDefaultEvent&&(e.stopPropagation(),e.preventDefault()),this.moveTo(i.fromEvent(e)))},e.decorators=[{type:n.Directive,args:[{selector:"[ngDraggable]",exportAs:"ngDraggable"}]}],e.ctorParameters=function(){return[{type:n.ElementRef},{type:n.Renderer2}]},e.propDecorators={started:[{type:n.Output}],stopped:[{type:n.Output}],edge:[{type:n.Output}],handle:[{type:n.Input}],bounds:[{type:n.Input}],outOfBounds:[{type:n.Input}],gridSize:[{type:n.Input}],zIndexMoving:[{type:n.Input}],zIndex:[{type:n.Input}],inBounds:[{type:n.Input}],trackPosition:[{type:n.Input}],scale:[{type:n.Input}],preventDefaultEvent:[{type:n.Input}],position:[{type:n.Input}],movingOffset:[{type:n.Output}],endOffset:[{type:n.Output}],ngDraggable:[{type:n.Input}],onMouseDown:[{type:n.HostListener,args:["mousedown",["$event"]]},{type:n.HostListener,args:["touchstart",["$event"]]}],onMouseLeave:[{type:n.HostListener,args:["document:mouseup"]},{type:n.HostListener,args:["document:mouseleave"]},{type:n.HostListener,args:["document:touchend"]},{type:n.HostListener,args:["document:touchcancel"]}],onMouseMove:[{type:n.HostListener,args:["document:mousemove",["$event"]]},{type:n.HostListener,args:["document:touchmove",["$event"]]}]},e}();function g(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}var s=function(){function e(e,t,n,i,s){var r=this;this.parent=e,this.renderer=t,this.type=n,this.css=i,this.onMouseDown=s;var o=t.createElement("div");t.addClass(o,"ng-resizable-handle"),t.addClass(o,i),"se"===n&&t.addClass(o,"ng-resizable-diagonal"),this.parent&&e.appendChild(o),this._onResize=function(e){s(e,r)},o.addEventListener("mousedown",this._onResize),o.addEventListener("touchstart",this._onResize),this._handle=o}return e.prototype.dispose=function(){this._handle.removeEventListener("mousedown",this._onResize),this._handle.removeEventListener("touchstart",this._onResize),this.parent&&this.parent.removeChild(this._handle),this._handle=null,this._onResize=null},Object.defineProperty(e.prototype,"el",{get:function(){return this._handle},enumerable:!0,configurable:!0}),e}(),r=function(){function i(e,t){this.width=e,this.height=t}return i.getCurrent=function(e){var t=new i(0,0);if(window){var n=window.getComputedStyle(e);return n&&(t.width=parseInt(n.getPropertyValue("width"),10),t.height=parseInt(n.getPropertyValue("height"),10)),t}return console.error("Not Supported!"),null},i}(),o=function(){function e(e,t){this.el=e,this.renderer=t,this._resizable=!0,this._handles={},this._handleType=[],this._handleResizing=null,this._origMousePos=null,this._origSize=null,this._origPos=null,this.rzHandles="e,s,se"}return Object.defineProperty(e.prototype,"ngResizable",{set:function(e){e!==undefined&&null!==e&&""!==e&&(this._resizable=!!e,this.updateResizable())},enumerable:!0,configurable:!0}),e.prototype.ngOnChanges=function(e){e.rzHandles&&!e.rzHandles.isFirstChange()&&this.updateResizable()},e.prototype.ngOnInit=function(){this.updateResizable()},e.prototype.ngOnDestroy=function(){this.removeHandles()},e.prototype.updateResizable=function(){var e=this.el.nativeElement;this.renderer.removeClass(e,"ng-resizable"),this.removeHandles(),this._resizable&&(this.renderer.addClass(e,"ng-resizable"),this.createHandles())},e.prototype.createHandles=function(){var e,t,n,i,s;if(this.rzHandles)if("string"==typeof this.rzHandles){e=this.rzHandles.replace(/ /g,"").toLowerCase().split(",");try{for(var r=g(e),o=r.next();!o.done;o=r.next()){var a=o.value;(d=this.createHandleByType(a,"ng-resizable-"+a))&&(this._handleType.push(a),this._handles[a]=d)}}catch(u){t={error:u}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(t)throw t.error}}}else{e=Object.keys(this.rzHandles);try{for(var h=g(e),l=h.next();!l.done;l=h.next()){var d;a=l.value;(d=this.createHandleByType(a,this.rzHandles[a]))&&(this._handleType.push(a),this._handles[a]=d)}}catch(p){i={error:p}}finally{try{l&&!l.done&&(s=h["return"])&&s.call(h)}finally{if(i)throw i.error}}}},e.prototype.createHandleByType=function(e,t){var n=this.el.nativeElement;return e.match(/^(se|sw|ne|nw|n|e|s|w)$/)?new s(n,this.renderer,e,t,this.onMouseDown.bind(this)):(console.error("Invalid handle type:",e),null)},e.prototype.removeHandles=function(){try{for(var e=g(this._handleType),t=e.next();!t.done;t=e.next()){var n=t.value;this._handles[n].dispose()}}catch(r){i={error:r}}finally{try{t&&!t.done&&(s=e["return"])&&s.call(e)}finally{if(i)throw i.error}}var i,s;this._handleType=[],this._handles={}},e.prototype.onMouseDown=function(e,t){if(!(e instanceof MouseEvent&&2===e.button||(e.stopPropagation(),e.preventDefault(),this._handleResizing))){var n=this.el.nativeElement;this._origMousePos=i.fromEvent(e),this._origSize=r.getCurrent(n),this._origPos=i.getCurrent(n),this.startResize(t)}},e.prototype.onMouseLeave=function(){this._handleResizing&&(this.stopResize(),this._origMousePos=null,this._origSize=null,this._origPos=null)},e.prototype.onMouseMove=function(e){this._handleResizing&&this._resizable&&this._origMousePos&&this._origPos&&this._origSize&&this.resizeTo(i.fromEvent(e))},e.prototype.startResize=function(e){this._handleResizing=e},e.prototype.stopResize=function(){this._handleResizing=null},e.prototype.resizeTo=function(e){var t=this.el.nativeElement;e.subtract(this._origMousePos),this._handleResizing.type.match(/n/)?(this.renderer.setStyle(t,"height",this._origSize.height-e.y+"px"),this.renderer.setStyle(t,"top",this._origPos.y+e.y+"px")):this._handleResizing.type.match(/s/)&&this.renderer.setStyle(t,"height",this._origSize.height+e.y+"px"),this._handleResizing.type.match(/e/)?this.renderer.setStyle(t,"width",this._origSize.width+e.x+"px"):this._handleResizing.type.match(/w/)&&(this.renderer.setStyle(t,"width",this._origSize.width-e.x+"px"),this.renderer.setStyle(t,"left",this._origPos.x+e.x+"px"))},e.decorators=[{type:n.Directive,args:[{selector:"[ngResizable]",exportAs:"ngResizable"}]}],e.ctorParameters=function(){return[{type:n.ElementRef},{type:n.Renderer2}]},e.propDecorators={ngResizable:[{type:n.Input}],rzHandles:[{type:n.Input}],onMouseLeave:[{type:n.HostListener,args:["document:mouseup"]},{type:n.HostListener,args:["document:mouseleave"]},{type:n.HostListener,args:["document:touchend"]},{type:n.HostListener,args:["document:touchcancel"]}],onMouseMove:[{type:n.HostListener,args:["document:mousemove",["$event"]]},{type:n.HostListener,args:["document:touchmove",["$event"]]}]},e}(),a=function(){function e(){}return e.decorators=[{type:n.NgModule,args:[{imports:[],declarations:[t,o],exports:[t,o]}]}],e}();e.AngularDraggableDirective=t,e.AngularResizableDirective=o,e.AngularDraggableModule=a,e.Position=i,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angular2-draggable.umd.min.js.map